## 相关知识点

知识点:

```R
8.24 提前掌握的知识：
1、计算标准差、均值、中间值、CV(标准差/均值)
2、计算两组数据的相关性（pearson、kendall、spearman）
3、T检验（Ttest）和方差检验（AnovaTest）
4、对数据做log2，求两组数据的foldchange（组1均值/组2均值）
5、逻辑回归预测模型
6、生存期预测模型（Cox）
```



```R
1.标准差 均值 中间值 CV(标准差/均值)
2.两组数据的相关性 (pearson皮尔逊  kendall秩  spearman斯皮尔曼)
3.T检验(TTest) 方差检验(Anova Test)
4.差异基因分析：fold change(差异倍数), P-value(差异的显著性)
  两组数据的fold change(fc 组1的均值/组2的均值 做log2处理) p-value
5.逻辑回归预测模型
6.生成器预测模型
7.时间序列预测模型
```



### quantile normalization 分位数归一化

用于做正态分布的平滑处理操作



表达矩阵的每一列都是一个样本，每一行都是一个基因或者探针，值就是表达量

跟普通矩阵相反 需要做转置处理

在R里面，推荐用preprocessCore 包来做quantile normalization



quantile normalization 原理: 

1. 对数据按列排序, 并记录真实数值的排序索引
2. 以行为单位, 计算平均值
3. 根据原始数据的索引位置, 将行平均值在列内重排

![分位数归一化.png](http://tva1.sinaimg.cn/large/006zzYLzgy1gvelbimd8ej60ii0phjz502.jpg)



### z-score 按比例缩放

z-score标准化是将数据按比例缩放，使之落入一个特定区间。 要求：均值 μ = 0 ，σ = 1为标准差公式\



Z-score：z分数能够真实的反应一个分数距离平均数的相对标准距离。如果我们把每一个分数都转换成z分数，那么每一个z分数会以标准差为单位表示一个具体分数到平均数的距离或离差。



### loess 局部加权回归

参考链接: https://blog.csdn.net/jesseyule/article/details/95245350

ggplot的loess拟合和loess拟合函数出来的曲线趋势是一致的。

但ggplot的预测数据只能从作图数据中提取，不仅只对应x和y轴的坐标，而且相比原始数据要少很多。

loess函数预测结果更适合用作后续分析，不过如果数据量较大，计算会比较耗时。



如果直接从数据出发进行分析就是非参数方法

非参数方法拟合得到的曲线可以更好地描述变量之间的关系，不管是多么复杂的曲线关系都能拟合得到。

loess（locally weighted regression）是一种用于局部回归分析的非参数方法，它主要是把样本划分成一个个小区间，对区间中的样本进行多项式拟合，不断重复这个过程得到在不同区间的加权回归曲线，最后再把这些回归曲线的中心连在一起合成完整的回归曲线，具体过程如下：

· 决定拟合点的数量和位置
· 以拟合点为中心，确定k个最接近的点
· 通过权重函数计算这k个点的权重
· 通过加权线性回归进行多项式拟合（一次或者二次）
· 对所有拟合点重复以上步骤

可以看到，损失函数加上权重之后，我们在最小化损失函数时，就会更多地考虑权重大的点，希望他们更优，这样拟合出来的结果，自然就更加偏向权重大的点了，也就是说，距离拟合点更近距离的散点，对拟合直线的影响更大。



### 相关性分析

相关性是指两个变量之间的变化趋势的一致性,如果两个变量变化趋势一致,那么就可以认为这两个变量之间存在着一定的关系 (但必须是有实际经济意义的两个变量才能说有一定的关系)。

相关性分析也是常用的统计方法

绘制相关图标, 计算相关系数 r

r 的绝对值越接近1 相关性越强, 越接近0 相关性越弱



相关性检验（pearson、spearman和kendall秩等）、cos相关性检验

pearson  皮尔逊相关系数 是用来衡量两个数据集合是否在一条线上面，它用来衡量[定距变量](https://baike.baidu.com/item/定距变量/2710255)间的[线性关系](https://baike.baidu.com/item/线性关系/1653156)。

​		如衡量国民收入和居民储蓄存款、身高和体重、高中成绩和高考成绩等变量间的[线性相关](https://baike.baidu.com/item/线性相关)关系。当两个变量都是正态[连续变量](https://baike.baidu.com/item/连续变量)，而且两者之间呈线性关系时，表现这两个变量之间相关程度用[积差相关系数](https://baike.baidu.com/item/积差相关系数)，主要有Pearson[简单相关系数](https://baike.baidu.com/item/简单相关系数)。

```python
相关系数的绝对值越大，相关性越强：相关系数越接近于1或-1，相关度越强，相关系数越接近于0，相关度越弱。
通常情况下通过以下取值范围判断变量的相关强度：
相关系数 0.8-1.0 极强相关
0.6-0.8 强相关
0.4-0.6 中等程度相关
0.2-0.4 弱相关
0.0-0.2 极弱相关或无相关
对于x,y之间的相关系数r ：
当r大于0小于1时表示x和y正相关关系
当r大于-1小于0时表示x和y负相关关系
当r=1时表示x和y完全正相关，r=-1表示x和y完全负相关
当r=0时表示x和y不相关
```



spearman  **斯皮尔曼等级相关系数** 衡量两个[变量](https://baike.baidu.com/item/变量)的[依赖性](https://baike.baidu.com/item/依赖性/3927846)的 非参数 指标

​		它利用[单调](https://baike.baidu.com/item/单调/9753519)方程评价两个统计变量的相关性。 如果数据中没有重复值， 并且当两个变量完全单调相关时，斯皮尔曼相关系数则为+1或−1。

kendall秩

​		n个同类的统计对象按特定属性排序，其他属性通常是乱序的。同序对（**concordant pairs**）和异序对（**discordant pairs**）之差与总对数（n*(n-1)/2)的比值定义为Kendall(肯德尔)系数。

例子: 

假如我们设一组8人的身高和体重在那里A的人是最高的，第三重，等等：

| **Person**         | **A** | **B** | **C** | **D** | **E** | **F** | **G** | **H** |
| ------------------ | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| **Rank by Height** | 1     | 2     | 3     | 4     | 5     | 6     | 7     | 8     |
| **Rank by Weight** | 3     | 4     | 1     | 2     | 5     | 7     | 8     | 6     |

我们看到，有一些相关的两个排名之间的相关性，可以使用Kendall系数，客观地衡量对应。

注意，A最高，但体重排名为 3 ，比体重排名为 4,5,6,7,8 的重，贡献5个同序对，即AB，AE，AF，AG，AH。

同理，我们发现B、C、D、E、F、G、H分别贡献4、5、4、3、1、0、0个同序对，

因此，同序对数 *P* = 5 + 4 + 5 + 4 + 3 + 1 + 0 + 0 = 22.

异序对数 Q=28-22 (总对数减去同序对数为异序对数)

因而R=((22-6)/28)=0.57。这一结果显示出强大的排名之间的规律，符合预期。



### 基因表达分析时,做差异分析DE,用于识别疾病,有以下2种方式:

1. fold change 差异倍数

2. t-test  T检验

   

### 差异性检验 T检验(T  Test)  方差检验(Anova Test)

##### T检验 T  Test

独立样本T检验一般仅仅比较两组数据有没有区别，区别的显著性，如比较两组人的身高，体重等等，而这两组一般都是独立的，没有联系的，只是比较这两组数据有没有统计学上的区别或差异。

##### 方差检验 Anova Test

单因素ANOVA也就是**单因素方差分析**，是用来研究一个控制变量的不同水平是否对观测变量产生了显著影响。

说白了就是分析 x 的变化对 y 的影响的显著性，所以一般变量之间存在某种影响关系的，验证一种变量的变化对另一种变量的影响显著性的检验。一般的，方差分析都是配对的。



### fold change (差异倍数)

参考链接: https://www.cnblogs.com/leezx/p/7132099.html

fold change 是倍数变化，假设A基因表达值为1，B表达值为3，那么B的表达就是A的3倍。基因表达值肯定是非负数，那么fold change的取值就是(0, +∞).



### p-value (差异的显著性)

P-value=P值

Significant Level=显著性水平，α

H0=原假设，null hypothesis

Ha=备择假设，alternative hypothesis，跟H0相反

当计算的P值<α, 否定H0值, 一定程度上表明Ha正确



### 逻辑回归预测模型



### 生成期预测模型

### 热图

面对庞大的数据, 可视化后展示数据的差异性, 了解数据的分布情况或差异情况, 也可以发现质量离谱的数据, 协助进行质量控制

在生信上, 多用于各种基因或RNA在不同样本中的表达

如果基因太多, 往往需要先做聚类

### 广义线性模型 glm()

参数 formula 数据关系 eg: y~x1+x2+x3

family 每一种响应分布 允许各种关联函数, 将均值和线性预测器关联起来

常用的 binomal(link='logit') 服从二项分布, 函数为逻辑回归

poisson(link='identity') 服从泊松分布, 函数为泊松回归

control: 控制算法误差和最大迭代次数 maxit

